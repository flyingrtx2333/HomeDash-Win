{{define "comfyui.html"}}
{{template "master.html" .}}
{{end}}

{{define "pages/comfyui-content"}}
  <div class="section-header">
    <div style="flex: 1;">
      <h2>AIç»˜ç”»</h2>
      <div id="workflowProgressHeader" style="display: none; margin-top: 12px;">
        <div class="progress-bar" style="width: 100%; height: 10px; margin-bottom: 6px;">
          <div class="progress-fill" id="workflowProgressFillHeader"></div>
        </div>
        <span id="workflowProgressTextHeader" style="font-size: 13px; color: var(--text-secondary);">ç­‰å¾…æ‰§è¡Œ...</span>
      </div>
    </div>
    <div class="ai-header-actions">
      <span class="comfyui-url-display" id="currentComfyUIUrlDisplay" title="ComfyUIæœåŠ¡å™¨åœ°å€">-</span>
      <button class="btn-outline" id="aiConfigBtn" title="é…ç½®ComfyUI">âš™ï¸</button>
      <button class="btn-outline" id="testComfyUIConnectionBtn" title="æµ‹è¯•è¿æ¥">ğŸ”—</button>
    </div>
  </div>

  <!-- å·¥ä½œæµå¡ç‰‡åˆ—è¡¨ -->
  <div class="section-header">
    <h3>å·¥ä½œæµ</h3>
  </div>
  <div class="workflow-grid" id="workflowGrid">
    <!-- å·¥ä½œæµå¡ç‰‡å°†ç”± JS åŠ¨æ€ç”Ÿæˆ -->
  </div>

  <!-- ComfyUIé…ç½®å¼¹çª— -->
  <div class="workflow-popup" id="comfyuiConfigModal" style="width: 360px;">
    <div class="workflow-popup-content">
      <div class="modal-header">
        <h3>ComfyUIé…ç½®</h3>
        <button class="modal-close" id="closeComfyUIConfigModal">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label>æœåŠ¡å™¨åœ°å€</label>
          <input type="text" class="form-control" id="comfyuiServerUrl" placeholder="ä¾‹å¦‚: http://localhost:8188" />
          <small class="form-hint">é…ç½®ComfyUIæœåŠ¡å™¨åœ°å€</small>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" id="cancelComfyUIConfigBtn">å–æ¶ˆ</button>
        <button class="btn-outline" id="saveComfyUIConfigBtn">ä¿å­˜</button>
      </div>
    </div>
  </div>

  <!-- å·¥ä½œæµæ‰§è¡Œé¢æ¿ï¼ˆå¼¹çª—ï¼‰ -->
  <div class="workflow-popup" id="workflowExecuteModal">
    <div class="workflow-popup-content">
      <div class="modal-header">
        <h3 id="workflowExecuteTitle">æ‰§è¡Œå·¥ä½œæµ</h3>
        <button class="modal-close" id="closeWorkflowExecuteModal">Ã—</button>
      </div>
      <div class="modal-body">
        <div id="workflowParamsForm">
          <!-- å‚æ•°è¡¨å•å°†ç”± JS åŠ¨æ€ç”Ÿæˆ -->
        </div>
        <div id="workflowProgress" style="display: none; margin-top: 20px;">
          <div class="progress-bar">
            <div class="progress-fill" id="workflowProgressFill"></div>
          </div>
          <p id="workflowProgressText">æ­£åœ¨æ‰§è¡Œ...</p>
        </div>
        <div id="workflowResult" style="display: none; margin-top: 20px;">
          <h4>ç”Ÿæˆç»“æœ</h4>
          <div id="workflowResultImages" class="workflow-result-images">
            <!-- ç»“æœå›¾ç‰‡å°†ç”± JS åŠ¨æ€ç”Ÿæˆ -->
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" id="cancelWorkflowExecuteBtn">å–æ¶ˆ</button>
        <button class="btn-outline" id="executeWorkflowBtn">æ‰§è¡Œ</button>
      </div>
    </div>
  </div>
{{end}}
